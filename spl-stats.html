<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>No Consolation</title>
  <link rel="stylesheet" href="stylesspl.css" />
  <link rel="stylesheet" href="stats.css">
  <link
    rel="stylesheet"
    href="https://use.fontawesome.com/releases/v5.14.0/css/all.css"
    integrity="sha384-HzLeBuhoNPvSl5KYnjx0BT+WB0QEEqLprO+NBkkk5gbc67FTaL7XIGa2w1L0Xbgc"
    crossorigin="anonymous"
  />
  <link
    href="https://fonts.googleapis.com/css2?family=Kumbh+Sans:wght@400;700&display=swap"
    rel="stylesheet"
  />

</head>
<body>

  <!-- Navbar Section -->
  <nav class="navbar">
    <div class="navbar__container">
      <a href="/" id="navbar__logo"><i class="fas fa-gem"></i>NC</a>
      <div class="navbar__toggle" id="mobile-menu">
        <span class="bar"></span> <span class="bar"></span> <span class="bar"></span>
      </div>
      <ul class="navbar__menu">
        <li class="navbar__item"><a href="/" class="navbar__links">Home</a></li>
        <li class="navbar__item"><a href="/streaming.html" class="navbar__links">Streaming</a></li>
        <li class="navbar__item"><a href="/podcasts.html" class="navbar__links">Podcasts</a></li>
        <li class="navbar__item"><a href="/roster.html" class="navbar__links">Info</a></li>
        <li class="navbar__item"><a href="/spl.html" class="navbar__links">SPL</a></li>
        <li class="navbar__btn">
          <a href="https://discord.gg/dzEZA3Jwm5" target="_blank" class="button">Get Notified</a>
        </li>
      </ul>
    </div>
  </nav>

  <!-- Secondary Nav Bar -->
  <nav class="sub-navbar">
    <ul class="sub-navbar__menu">
      <li><a href="/spl.html">SPL Home</a></li>
      <li><a href="/spl-stats.html">Stats</a></li>
      <li><a href="/spl-rosters.html">Rosters</a></li>
      <li><a href="/splszn2.html">Season 2</a></li>
    </ul>
  </nav>

    <nav class="submenu">
    <button onclick="showSection('section1')">League Leaders</button>
    <button onclick="showSection('section2')">Player Stats</button>
    <button onclick="showSection('section3')">Team Stats</button>
    <button onclick="showSection('section4')">Map Stats</button>
    </nav>



    <div id="panelContainer" class="grid-container"></div>
    <div id="detailModal" class="modal">
    <div class="modal-content">
        <span id="closeModal" class="close">&times;</span>
        <div id="detailContent"></div>
    </div>
    </div>






  <!-- Footer Section -->
  <div class="footer__container">
    <div class="footer__links">
      <div class="footer__link--wrapper">
        <div class="footer__link--items">
          <h2>About Us</h2>
          <a href="/info.html">Mission</a>
          <a href="/info.html">Vision</a>
          <a href="/info.html">Roster</a>
        </div>
        <div class="footer__link--items">
          <h2>Standings</h2>
          <a href="/info.html">Statistics</a>
        </div>
      </div>
      <div class="footer__link--wrapper">
        <div class="footer__link--items">
          <h2>Contact Us</h2>
          <a href="https://discord.gg/dzEZA3Jwm5">Discord</a>
        </div>
        <div class="footer__link--items">
          <h2>Social Media</h2>
          <a href="https://twitch.tv/noconsolation" target="_blank">Twitch</a>
          <a href="https://www.tiktok.com/@noconsolation?lang=en" target="_blank">TikTok</a>
          <a href="https://www.youtube.com/@thereisnoconsolation" target="_blank">YouTube</a>
          <a href="https://twitter.com/NoConsolation_" target="_blank">Twitter</a>
        </div>
      </div>
    </div>
    <section class="social__media">
      <div class="social__media--wrap">
        <div class="footer__logo">
          <a href="/" id="footer__logo"><i class="fas fa-gem"></i>No Consolation</a>
        </div>
        <p class="website__rights">Â© No Consolation 2023. All rights reserved</p>
        <div class="social__icons">
          <a
            class="social__icon--link"
            href="https://twitch.tv/noconsolation"
            target="_blank"
            ><i class="fab fa-twitch"></i
          ></a>
          <a
            class="social__icon--link"
            href="https://discord.gg/dzEZA3Jwm5"
            target="_blank"
            ><i class="fab fa-discord"></i
          ></a>
          <a
            class="social__icon--link"
            href="https://www.youtube.com/@thereisnoconsolation"
            target="_blank"
            ><i class="fab fa-youtube"></i
          ></a>
          <a
            class="social__icon--link"
            href="https://twitter.com/NoConsolation_"
            target="_blank"
            ><i class="fab fa-twitter"></i
          ></a>
          <a
            class="social__icon--link"
            href="https://www.tiktok.com/@noconsolation?lang=en"
            target="_blank"
            ><i class="fab fa-tiktok"></i
          ></a>
        </div>
      </div>
    </section>
  </div>

    <script src="app.js"></script>

    <script>
    function showSection(id) {
        const sections = document.querySelectorAll('.content-section');
        sections.forEach(section => {
        section.style.display = section.id === id ? 'block' : 'none';
        });
    }
    </script>



<script>
const container = document.getElementById('panelContainer'); // Your main grid container
let panelIndex = 0;

// Define the 12 ranges for each stat panel (adjust to your real ranges)


// Initial fetch to build panels grid from A18:H29 (or your actual panel header location)
fetch("https://script.google.com/macros/s/AKfycbwA1MIAHTAif1_al8IDs6KE3herlDSzZEvD6UqCOjq0sW068RBUzCePncNqaAAsGMk6EQ/exec")
  .then(res => res.json())
  .then(data => {
    for (let row = 0; row <= 8; row += 4) {
      for (let col = 0; col < 8; col += 2) {
        const panel = document.createElement('div');
        panel.className = 'panel';
        panel.style.cursor = 'pointer';

        const headerData = data[row][col];
        const header = document.createElement('h3');
        header.textContent = headerData.value;
        header.style.backgroundColor = '#333';
        header.style.color = 'white';
        panel.appendChild(header);

        const table = document.createElement('table');
        for (let i = 1; i <= 3; i++) {
          const tr = document.createElement('tr');
          for (let j = 0; j < 2; j++) {
            const cellData = data[row + i][col + j];
            const td = document.createElement('td');
            let val = cellData.value;
            if (typeof val === "number") val = val.toFixed(1);
            td.textContent = val;
            td.style.backgroundColor = cellData.bgColor;
            tr.appendChild(td);
          }
          table.appendChild(tr);
        }

        panel.appendChild(table);
        panel.setAttribute('data-panel-index', panelIndex);
        panel.addEventListener('click', () => {
          const index = panel.getAttribute('data-panel-index');
          openDetailForPanel(parseInt(index, 10));
        });

        container.appendChild(panel);
        panelIndex++;
      }
    }
  })
  .catch(err => console.error("Error loading panels:", err));


// Fetch and show detail panel for clicked stat index
const rangesByPanel = {
  0: "a3:d8",
  1: "e3:h7",
  2: "i3:l7",
  3: "m3:p7",
  4: "a11:d16",
  5: "e11:h15",
  6: "i11:l15",
  7: "m11:p15",
  8: "a18:b25",
  9: "e19:h23",
  10: "i19:l23",
  11: "m19:p23"
};

const titles = [
  "Team Goals per Game",
  "Goals per Game",
  "Megastrike Goals per Game",
  "Skill Shot Goals",
  "Team Goals Against per Game",
  "Striker Index",
  "Impact",
  "Skill Shot Assists",
  "Map Goals per Game",
  "Sidekick Goals per Game",
  "Sidekick Impact",
  "Skill Shot Participation"
];

function getRangeData(sheetData, range) {
  const colToIndex = col => col.charCodeAt(0) - 'A'.charCodeAt(0);
  const [start, end] = range.split(':');
  const startCol = colToIndex(start[0]);
  const startRow = parseInt(start.slice(1)) - 1;
  const endCol = colToIndex(end[0]);
  const endRow = parseInt(end.slice(1)) - 1;

  // if sheetData has .values property, use that
  const data = Array.isArray(sheetData) ? sheetData : (sheetData.values || []);

  return data.slice(startRow, endRow + 1).map(row =>
    row.slice(startCol, endCol + 1)
  );
}

const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwA1MIAHTAif1_al8IDs6KE3herlDSzZEvD6UqCOjq0sW068RBUzCePncNqaAAsGMk6EQ/exec";

function openDetailForPanel(index) {
  fetch(`${SCRIPT_URL}?panel=${index}`)
    .then(res => res.json())
    .then(data => {
      if (index === 8) {
        // Panel 8: simple 8 rows x 2 cols, no SPL/MLS split
        const rows = data.map(row => [row[0].value, row[1].value]);
        showSimpleTableModal({
          title: titles[index] || "Untitled",
          rows: rows
        });
      } else {
        // Default: split into SPL and MLS columns
        const splRows = data.map(row => [row[0].value, row[1].value]);
        const mlsRows = data.map(row => [row[2].value, row[3].value]);
        showDetailModal([
          { title: titles[index] || "Untitled SPL", rows: splRows },
          { title: titles[index] || "Untitled MLS", rows: mlsRows }
        ]);
      }
    })
    .catch(err => console.error("Error fetching panel detail:", err));
}



// Keep your showDetailModal as is, but when setting textContent:
// Example:
// if (typeof value === 'number') value = value.toFixed(1);
// td.textContent = value;



// Modal logic and close button
const modal = document.getElementById("detailModal");
const closeBtn = document.getElementById("closeModal");
closeBtn.onclick = () => modal.classList.remove("show");

window.onclick = (event) => {
  if (event.target === modal){
    modal.classList.remove("show");
  }
};

// Your existing showDetailModal function to render the data nicely
function showDetailModal(blocks,panelIndex) {
  if (!blocks || !Array.isArray(blocks) || blocks.length === 0) {
    console.warn("Invalid modal data.");
    return;
  }

  const container = document.getElementById("detailContent");
  container.innerHTML = "";

  const table = document.createElement("table");
  table.style.width = "100%";
  table.style.borderCollapse = "collapse";
  table.style.tableLayout = "fixed";

  const thead = document.createElement("thead");

  // Big title row spanning all 5 columns
  const titleRow = document.createElement("tr");
  const titleCell = document.createElement("th");
  titleCell.colSpan = 5;
  titleCell.textContent = blocks[0].title || "Untitled";
  titleCell.style.textAlign = "center";
  titleCell.style.fontWeight = "bold";
  titleCell.style.fontSize = "1.4em";
  titleCell.style.padding = "10px";
  titleCell.style.backgroundColor = "#333";
  titleCell.style.color = "white";
  titleCell.style.border = "1px solid #ccc";
  titleRow.appendChild(titleCell);
  thead.appendChild(titleRow);

  // Header row: #, SPL (colspan=2), MLS (colspan=2)
  const headerRow1 = document.createElement("tr");

  const thNum = document.createElement("th");
  thNum.rowSpan = 2;
  thNum.textContent = "#";
  thNum.style.border = "1px solid #ccc";
  thNum.style.padding = "6px";
  thNum.style.backgroundColor = "#ddd";
  thNum.style.width = "10%";
  headerRow1.appendChild(thNum);

  const thSpl = document.createElement("th");
  thSpl.colSpan = 2;
  thSpl.textContent = "SPL";
  thSpl.style.border = "1px solid #ccc";
  thSpl.style.padding = "6px";
  thSpl.style.backgroundColor = "orangered";
  thSpl.style.color = "white";
  thSpl.style.textAlign = "center";
  thSpl.style.width = "45%";
  headerRow1.appendChild(thSpl);

  const thMls = document.createElement("th");
  thMls.colSpan = 2;
  thMls.textContent = "MLS";
  thMls.style.border = "1px solid #ccc";
  thMls.style.padding = "6px";
  thMls.style.backgroundColor = "teal";
  thMls.style.color = "white";
  thMls.style.textAlign = "center";
  thMls.style.width = "45%";
  headerRow1.appendChild(thMls);

  thead.appendChild(headerRow1);

  table.appendChild(thead);

  const tbody = document.createElement("tbody");

const modal = document.getElementById("detailModal");

  // Use the max rows available from SPL or MLS rows for safety
  const splLength = blocks[0].rows.length;
  const mlsLength = blocks[1].rows.length;
  const maxRows = Math.max(splLength, mlsLength);

  // If you want to force 6 rows for panels 0 and 4, otherwise number of rows available:
  const numRows = (panelIndex === 0 || panelIndex === 4) ? Math.max(6, maxRows) : maxRows;

  // Then loop from 0 to numRows - 1
  for (let i = 0; i < numRows; i++) {
    const tr = document.createElement("tr");

    // Row number
    const tdNum = document.createElement("td");
    tdNum.textContent = i + 1;
    tdNum.style.fontWeight = "bold";
    tdNum.style.border = "1px solid #ccc";
    tdNum.style.padding = "6px";
    tdNum.style.backgroundColor = "#f0f0f0";
    tdNum.style.width = "10%";
    tdNum.style.textAlign = "center";
    tr.appendChild(tdNum);

    // SPL Player name
    const splPlayer = (blocks[0].rows[i] && blocks[0].rows[i][0]) ?? "";
    const tdSplPlayer = document.createElement("td");
    tdSplPlayer.textContent = splPlayer;
    tdSplPlayer.style.border = "1px solid #ccc";
    tdSplPlayer.style.padding = "6px";
    tdSplPlayer.style.width = "22.5%";
    tdSplPlayer.style.backgroundColor = "#f0f0f0";
    tr.appendChild(tdSplPlayer);

    // SPL Player number
    let splNum = (blocks[0].rows[i] && blocks[0].rows[i][1]) ?? "";
    if (typeof splNum === "number") splNum = splNum.toFixed(1);
    const tdSplNum = document.createElement("td");
    tdSplNum.textContent = splNum;
    tdSplNum.style.border = "1px solid #ccc";
    tdSplNum.style.padding = "6px";
    tdSplNum.style.width = "22.5%";
    tdSplNum.style.backgroundColor = "#f0f0f0";
    tr.appendChild(tdSplNum);

    // MLS Player name
    const mlsPlayer = (blocks[1].rows[i] && blocks[1].rows[i][0]) ?? "";
    const tdMlsPlayer = document.createElement("td");
    tdMlsPlayer.textContent = mlsPlayer;
    tdMlsPlayer.style.border = "1px solid #ccc";
    tdMlsPlayer.style.padding = "6px";
    tdMlsPlayer.style.width = "22.5%";
    tdMlsPlayer.style.backgroundColor = "#f0f0f0";
    tr.appendChild(tdMlsPlayer);

    // MLS Player number
    let mlsNum = (blocks[1].rows[i] && blocks[1].rows[i][1]) ?? "";
    if (typeof mlsNum === "number") mlsNum = mlsNum.toFixed(1);
    const tdMlsNum = document.createElement("td");
    tdMlsNum.textContent = mlsNum;
    tdMlsNum.style.border = "1px solid #ccc";
    tdMlsNum.style.padding = "6px";
    tdMlsNum.style.width = "22.5%";
    tdMlsNum.style.backgroundColor = "#f0f0f0";
    tr.appendChild(tdMlsNum);

    tbody.appendChild(tr);
  }


  table.appendChild(tbody);
  container.appendChild(table);

  modal.classList.add("show");
}


function showSimpleTableModal(block) {
  const container = document.getElementById("detailContent");
  container.innerHTML = "";

  const table = document.createElement("table");
  table.style.width = "100%";
  table.style.borderCollapse = "collapse";

  const thead = document.createElement("thead");

  // Title row spanning 3 columns (# + 2 data columns)
  const titleRow = document.createElement("tr");
  const titleCell = document.createElement("th");
  titleCell.colSpan = 3;
  titleCell.textContent = block.title;
  titleCell.style.textAlign = "center";
  titleCell.style.backgroundColor = "#333";
  titleCell.style.color = "white";
  titleCell.style.padding = "10px";
  titleRow.appendChild(titleCell);
  thead.appendChild(titleRow);

  // Header row

  table.appendChild(thead);

  const tbody = document.createElement("tbody");

  block.rows.forEach((row, i) => {
    const tr = document.createElement("tr");

    // Row number
    const tdNum = document.createElement("td");
    tdNum.textContent = i + 1;
    tdNum.style.border = "1px solid #ccc";
    tdNum.style.padding = "6px";
    tdNum.style.backgroundColor = "#f0f0f0";
    tr.appendChild(tdNum);

    // Column 1
    const td1 = document.createElement("td");
    td1.textContent = row[0];
    td1.style.border = "1px solid #ccc";
    td1.style.padding = "6px";
    td1.style.backgroundColor='#f0f0f0';
    tr.appendChild(td1);

    // Column 2
    const td2 = document.createElement("td");
    td2.textContent = row[1];
    td2.style.border = "1px solid #ccc";
    td2.style.padding = "6px";
    td2.style.backgroundColor='#f0f0f0';
    tr.appendChild(td2);

    tbody.appendChild(tr);
  });

  table.appendChild(tbody);
  container.appendChild(table);

  // Show the modal
  const modal = document.getElementById("detailModal");
  modal.classList.add("show");
}

</script>



</body>
</html>
