<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>No Consolation</title>
  <link rel="stylesheet" href="stylesspl.css" />
  <link
    rel="stylesheet"
    href="https://use.fontawesome.com/releases/v5.14.0/css/all.css"
    integrity="sha384-HzLeBuhoNPvSl5KYnjx0BT+WB0QEEqLprO+NBkkk5gbc67FTaL7XIGa2w1L0Xbgc"
    crossorigin="anonymous"
  />
  <link
    href="https://fonts.googleapis.com/css2?family=Kumbh+Sans:wght@400;700&display=swap"
    rel="stylesheet"
  />
</head>


  <!-- Navbar Section -->
  <nav class="navbar">
    <div class="navbar__container">
      <a href="/" id="navbar__logo"><i class="fas fa-gem"></i>NC</a>
      <div class="navbar__toggle" id="mobile-menu">
        <span class="bar"></span> <span class="bar"></span> <span class="bar"></span>
      </div>
      <ul class="navbar__menu">
        <li class="navbar__item"><a href="/" class="navbar__links">Home</a></li>
        <li class="navbar__item"><a href="/streaming.html" class="navbar__links">Streaming</a></li>
        <li class="navbar__item"><a href="/podcasts.html" class="navbar__links">Podcasts</a></li>
        <li class="navbar__item"><a href="/roster.html" class="navbar__links">Info</a></li>
        <li class="navbar__item"><a href="/spl.html" class="navbar__links">SPL</a></li>
        <li class="navbar__btn">
          <a href="https://discord.gg/dzEZA3Jwm5" target="_blank" class="button">Get Notified</a>
        </li>
      </ul>
    </div>
  </nav>

  <!-- Secondary Nav Bar -->
  <nav class="sub-navbar">
    <ul class="sub-navbar__menu">
      <li><a href="/spl.html">SPL Home</a></li>
      <li><a href="/spl-stats.html">Stats</a></li>
      <li><a href="/spl-rosters.html">Rosters</a></li>
      <li><a href="/splszn2.html">Season 2</a></li>
    </ul>
  </nav>


<style>
  body {
    font-family: 'Kumbh Sans', sans-serif;
  }

  table {
    border-collapse: collapse;
    margin: 20px auto; /* centers the table */
    text-align: center;
    width: 90%;
    table-layout: fixed; /* equal column width distribution */
    background-color: #666666; /* table background */
    box-shadow: 0 2px 5px rgba(0,0,0,0.1); /* subtle shadow */
  }

  th, td {
    border: 1px solid #000;
    padding: 8px;
    overflow: hidden;
    text-align: center;
  }

  /* Header colors for first 5 tables (SPL) */
  .header-spl th {
    background-color: orangered;
    color: black;
  }

  /* Header colors for last 5 tables (MLS) */
  .header-mls th {
    background-color: teal;
    color: black;
  }

  /* Bold first column */
  td:first-child {
    font-weight: bold;
  }
    select {
    padding: 8px 12px;          /* bigger padding for size */
    font-size: 16px;            /* larger text */
    background-color: #e0e0e0;  /* light grey background */
    border: 1px solid #ccc;     /* subtle border */
    border-radius: 5px;         /* rounded corners */
    min-width: 150px;           /* consistent width */
    cursor: pointer;            /* pointer on hover */
    transition: all 0.2s ease;
    
  }

  select:hover {
    background-color: #d5d5d5;  /* slightly darker on hover */
  }

  select:focus {
    outline: none;
    border-color: #4CAF50;     /* highlight on focus */
    box-shadow: 0 0 5px rgba(0, 128, 0, 0.5);
  }
    option.duplicate {
    color: #999;          /* light grey text */
    font-style: italic;   /* italicized */
  }
  
#submitVote {
  display: block;
  margin: 30px auto 10px auto;
  padding: 16px 0;
  width: 1200px; /* same width as SPL button */
  font-size: 1.2rem;
  font-weight: bold;
  background: linear-gradient(135deg, #8e44ad, #50a5d5);
  color: white;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
  transition: all 0.3s ease;
}

#submitVote:hover {
  background: linear-gradient(135deg, #9b59b6, #8e44ad);
  transform: scale(1.05);
  box-shadow: 0 6px 14px rgba(0, 0, 0, 0.3);
}

#submitVote:disabled {
  background: #666 !important;
  cursor: not-allowed;
  opacity: 0.5;
  transform: none;
  box-shadow: none;
}

.major-row-end td {
  font-weight: bold;           /* bold all cells in bottom row */
  border-bottom: 4px solid #000; /* keeps thick divider */
}


  
</style>


<body>
  <div style="text-align: center; margin-top: 40px; margin-bottom: 20px;">
    <h1 style="font-size: 48px; color: #fff; text-decoration: underline;">SPL Season 4 All Star Voting</h1>
    <p style="font-size: 20px; color: #ccc; margin-top: 10px;">
      *Select your top 3, at least 2 series played at that position to qualify, minimum 2 nominees per team, 1 vote per coach*
    </p>
       <p style="font-size: 20px; color: #ccc; margin-top: 10px;">
      *Order in the table was randomized*
    </p>
    <p style="font-size: 20px; color: #ccc; margin-top: 15px;">
      *Top <strong>Colored</strong> row is stats at that position | Bottom <strong>Bold</strong> row is full season stats*
    </p>
  </div>
<div style="display: flex; align-items: center; justify-content: center; gap: 12px; margin: 20px 0;">
  <label for="voterSelect" style="color: #ccc; font-size: 1.2rem; display: block; margin-bottom: 8px;">
    Name:
  </label>
  <input
    type="text" 
    id="voterSelect" 
    name="voterSelect" 
    placeholder="Name goes here..." 
    style="padding: 10px 12px; font-size: 1rem; border-radius: 6px; border: 1px solid #aaa; background-color: #222; color: #eee; min-width: 200px; width: 50%;"
  />
</div>



<!-- Example HTML -->
<table id="SPL_ST" border="1"></table>
<table id="SPL_TM" border="1"></table>
<table id="SPL_BM" border="1"></table>
<table id="SPL_DEF" border="1"></table>
<table id="SPL_Util" border="1"></table>
<table id="SPL_MGR" border="1"></table>
<table id="MLS_ST" border="1"></table>
<table id="MLS_TM" border="1"></table>
<table id="MLS_BM" border="1"></table>
<table id="MLS_DEF" border="1"></table>
<table id="MLS_Util" border="1"></table>
<table id="MLS_MGR" border="1"></table>


<div style="text-align: center; margin: 40px 0;">
  <button id="submitVote" type="button">
    Submit
  </button>



<script>
const sheetUrl =
  "https://docs.google.com/spreadsheets/d/e/2PACX-1vTk_yyYJL6SZMkR56CtCoJLDSnI79GyP0r7Js_vFzLQ0kZEI1Xc96bFIqPdzm7PLA-U40CxvoklFXQc/pub?gid=1784266098&single=true&output=csv";

const tables = [
  {
    id: "SPL_ST",
    title: "Striker - SPL", 
    titleColor: "#ea4335",
    range: { rowStart: 3, rowEnd: 9, colStart: 1, colEnd: 9 }
  },
  {
  id: "SPL_TM",
  title: "Top Mid - SPL",
  titleColor: "#34a853",
  topRowColor:"#34a853",
  range: { rowStart: 11, rowEnd: 23, colStart: 1, colEnd: 9 }
},
{
  id: "SPL_BM",
  title: "Bot Mid - SPL",
  titleColor: "#4285f4",
  topRowColor:"#4285f4",
  range: { rowStart: 25, rowEnd: 37, colStart: 1, colEnd: 9 }
},
{
  id: "SPL_DEF",
  title: "Defense - SPL",
  titleColor: "#fbbc04",
  topRowColor:"#fbbc04",
  range: { rowStart: 39, rowEnd: 51, colStart: 1, colEnd: 9 }
},
{
  id: "SPL_Util",
  title: "Utility - SPL",
  subtitle: "For Each Player, Vote Yes if they Deserve to be an All Star, No if they do not",
  range:{ rowStart: 53, rowEnd: 59, colStart: 1, colEnd: 10 },
  type: "utility"
},
  { id: "SPL_MGR", title: "Manager - SPL", range: { rowStart: 61, rowEnd: 67, colStart: 0, colEnd: 8 } },
  {
    id: "MLS_ST",
    title: "Striker - MLS", 
    titleColor: "#ea4335",
    range: { rowStart: 3, rowEnd: 9, colStart: 11, colEnd: 19 }
  },
  {
  id: "MLS_TM",
  title: "Top Mid - MLS",
  titleColor: "#34a853",
  topRowColor:"#34a853",
  range: { rowStart: 11, rowEnd: 23, colStart: 11, colEnd: 19 }
},
{
  id: "MLS_BM",
  title: "Bot Mid - MLS",
  titleColor: "#4285f4",
  topRowColor:"#4285f4",
  range: { rowStart: 25, rowEnd: 37, colStart: 11, colEnd: 19 }
},
{
  id: "MLS_DEF",
  title: "Defense - MLS",
  titleColor: "#fbbc04",
  topRowColor:"#fbbc04",
  range: { rowStart: 39, rowEnd: 51, colStart: 11, colEnd: 19 }
},
{
  id: "MLS_Util",
  title: "Utility - MLS",
  subtitle: "For Each Player, Vote Yes if they Deserve to be an All Star, No if they do not",
  range:{ rowStart: 53, rowEnd: 59, colStart: 11, colEnd: 20 },
  type: "utility"
},
  { id: "MLS_MGR", title: "Manager - MLS", range: { rowStart: 61, rowEnd: 67, colStart: 10, colEnd: 18 } }
];

fetch(sheetUrl)
  .then(res => res.text())
  .then(csv => {
    const rows = csv.split("\n").map(r => r.split(","));

    tables.forEach(def => {
      const table = document.getElementById(def.id);
      if (!table) return;
      table.innerHTML = "";

// --- Table Title ---
    const title = document.createElement("h3");
    title.textContent = def.title;
    title.style.textAlign = "center";
    title.style.margin = "75px 0 10px";
    title.style.color = def.titleColor || "#fff";
    title.style.fontSize = "30px";
    title.style.textDecoration = "underline";
    table.parentNode.insertBefore(title, table);

    // --- Subtitle (optional) ---
    if (def.subtitle) {
      const subtitle = document.createElement("h4");
      subtitle.textContent = def.subtitle;
      subtitle.style.textAlign = "center";
      subtitle.style.margin = "0 0 15px"; // space below subtitle
      subtitle.style.color = "#ccc";      // grey subtitle
      subtitle.style.fontSize = "18px";   // smaller than main title
      table.parentNode.insertBefore(subtitle, table);
}


      // --- Header styling ---
      if (def.id.startsWith("SPL")) {
        table.classList.add("header-spl");
      } else if (def.id.startsWith("MLS")) {
        table.classList.add("header-mls");
      }

      // --- Headers ---
      const headers = def.id.endsWith("MGR")
        ? ["Coach","Team", "Points", "Win%", "GF/g", "GA/g", "GD", "Snipes"]
        : def.type === "utility"
          ? ["Player", "Team", "Series", "Win %", "Goals/g", "Striker Index", "Impact", "+/-", "Vote"]
          : ["Player", "Team", "Series", "Win %", "Goals/g", "Striker Index", "Impact", "+/-"];

      const headerRow = document.createElement("tr");
      headers.forEach(h => {
        const th = document.createElement("th");
        th.textContent = h;
        headerRow.appendChild(th);
      });
      table.appendChild(headerRow);

      // --- Data ---
      const dataRows = rows.slice(def.range.rowStart, def.range.rowEnd);

      // --- Utility Tables (Yes/No) ---
      if (def.type === "utility") {
        dataRows.forEach((row, i) => {
          const tr = document.createElement("tr");
          for (let c = def.range.colStart; c < def.range.colEnd - 1; c++) {
            const td = document.createElement("td");
            td.textContent = row[c] || "";
            tr.appendChild(td);
          }
          const tdVote = document.createElement("td");
          const select = document.createElement("select");
          select.name = def.id.toLowerCase() + "_row" + i;
          select.required = true;

          ["--", "Yes", "No"].forEach(val => {
            const option = document.createElement("option");
            option.value = val === "--" ? "" : val;
            option.textContent = val;
            if (val === "--") { option.selected = true; option.disabled = true; }
            select.appendChild(option);
          });

          tdVote.appendChild(select);
          tr.appendChild(tdVote);
          table.appendChild(tr);
        });
      }

      // --- Split-row tables (TM/BM/DEF) ---
      else if (def.id.includes("_TM") || def.id.includes("_BM") || def.id.includes("_DEF")) {
        const firstColValues = [];

        for (let i = 0; i < dataRows.length; i += 2) {
          const rowA = dataRows[i];
          const rowB = dataRows[i + 1] || [];

          const trTop = document.createElement("tr");
          const trBottom = document.createElement("tr");
          trBottom.classList.add("major-row-end");

          for (let c = def.range.colStart; c < def.range.colEnd; c++) {
            if (c < def.range.colStart + 2) {
              const td = document.createElement("td");
              td.textContent = rowA[c] || "";
              td.rowSpan = 2;
              trTop.appendChild(td);

              if (c === def.range.colStart && rowA[c]) firstColValues.push(rowA[c]);
            } else {
              const tdTop = document.createElement("td");
              tdTop.textContent = rowA[c] || "";
              tdTop.style.color = def.topRowColor || "#64b5f6";
              trTop.appendChild(tdTop);

              const tdBottom = document.createElement("td");
              tdBottom.textContent = rowB[c] || "";
              tdBottom.style.fontWeight = "bold";
              trBottom.appendChild(tdBottom);
            }
          }

          table.appendChild(trTop);
          table.appendChild(trBottom);
        }

        // --- Top-3 dropdowns below table ---
        const form = document.createElement("form");
        form.style.display = "flex";
        form.style.justifyContent = "space-between";
        form.style.margin = "20px auto";
        form.style.width = "90%";

        ["First Choice", "Second Choice", "Third Choice"].forEach((labelText, i) => {
          const box = document.createElement("div");
          box.style.width = "30%";
          box.style.textAlign = "center";

          const label = document.createElement("div");
          label.textContent = labelText;
          label.style.fontWeight = "bold";
          label.style.color = "#ccc";
          label.style.marginBottom = "5px";

          const select = document.createElement("select");
          select.name = def.id.toLowerCase() + "_" + (i + 1);
          select.required = true;
          select.style.width = "100%";
          select.style.padding = "8px";
          select.style.fontSize = "16px";

          // Default option
          const defaultOption = document.createElement("option");
          defaultOption.value = "";
          defaultOption.textContent = "-- Select --";
          defaultOption.selected = true;
          defaultOption.disabled = true;
          select.appendChild(defaultOption);

          // First-column values as options
          firstColValues.forEach(v => {
            const option = document.createElement("option");
            option.value = v;
            option.textContent = v;
            select.appendChild(option);
          });

          box.append(label, select);
          form.appendChild(box);
        });

        table.parentNode.insertBefore(form, table.nextSibling);
      }

      // --- Normal tables (like Strikers) ---
      else {
        dataRows.forEach(row => {
          const tr = document.createElement("tr");
          for (let c = def.range.colStart; c < def.range.colEnd; c++) {
            const td = document.createElement("td");
            td.textContent = row[c] || "";
            tr.appendChild(td);
          }
          table.appendChild(tr);
        });

        // --- Top-3 dropdown ---
        const firstColValues = dataRows.map(r => r[def.range.colStart] || "");
        const form = document.createElement("form");
        form.style.display = "flex";
        form.style.justifyContent = "space-between";
        form.style.margin = "20px auto";
        form.style.width = "90%";

        ["First Choice", "Second Choice", "Third Choice"].forEach((labelText, i) => {
          const box = document.createElement("div");
          box.style.width = "30%";
          box.style.textAlign = "center";

          const label = document.createElement("div");
          label.textContent = labelText;
          label.style.fontWeight = "bold";
          label.style.color = "#ccc";
          label.style.marginBottom = "5px";

          const select = document.createElement("select");
          select.name = def.id.toLowerCase() + "_" + (i + 1);
          select.required = true;
          select.style.width = "100%";
          select.style.padding = "8px";
          select.style.fontSize = "16px";

          select.innerHTML = `<option value="" disabled selected>-- Select --</option>`;
          firstColValues.forEach(v => {
            const o = document.createElement("option");
            o.value = v;
            o.textContent = v;
            select.appendChild(o);
          });

          box.append(label, select);
          form.appendChild(box);
        });

        table.parentNode.insertBefore(form, table.nextSibling);
      }
    }); // tables.forEach
  }); // fetch.then

// ---- Submit ----
document.getElementById("submitVote").addEventListener("click", function () {
  const btn = this;
  btn.disabled = true;
  btn.textContent = "Submitting...";

  const voter = document.getElementById("voterSelect").value || "Missing";
  const data = { voter };

  // --- Top 3 dropdowns ---
  [
    "spl_st","spl_tm","spl_bm","spl_def","spl_mgr",
    "mls_st","mls_tm","mls_bm","mls_def","mls_mgr"
  ].forEach(cat => {
    for (let i = 1; i <= 3; i++) {
      const sel = document.querySelector(`select[name='${cat}_${i}']`);
      data[`${cat}_${i}`] = sel?.value || "Missing";
    }
  });

  // --- Utility Yes/No votes ---
  ["spl_util","mls_util"].forEach(cat => {
    const selects = document.querySelectorAll(`select[name^='${cat}_row']`);
    selects.forEach((sel, index) => {
      data[`${cat}_row${index}`] = sel?.value || "Missing";
    });
  });

  // --- Send to Apps Script ---
  fetch("https://script.google.com/macros/s/AKfycbyf_xEElGv7RLnIewiRjmbnrwbzstsLjEMOQH-o85diiISBQ1EjUJxoPt_Jdr3n83nqnA/exec", {
    method: "POST",
    body: JSON.stringify(data),
  })
    .then(r => r.text())
    .then(t => {
      if (t === "Success") {
        alert("Vote submitted!");
      } else {
        alert("Error: " + t);
      }
    })
    .catch(err => {
      alert("Fetch error: " + err);
      console.error(err);
    })
    .finally(() => {
      btn.disabled = false;
      btn.textContent = "Submit";
    });
});

</script>









  <!-- Footer Section -->
  <div class="footer__container">
    <div class="footer__links">
      <div class="footer__link--wrapper">
        <div class="footer__link--items">
          <h2>About Us</h2>
          <a href="/info.html">Mission</a>
          <a href="/info.html">Vision</a>
          <a href="/info.html">Roster</a>
        </div>
        <div class="footer__link--items">
          <h2>Standings</h2>
          <a href="/info.html">Statistics</a>
        </div>
      </div>
      <div class="footer__link--wrapper">
        <div class="footer__link--items">
          <h2>Contact Us</h2>
          <a href="https://discord.gg/dzEZA3Jwm5">Discord</a>
        </div>
        <div class="footer__link--items">
          <h2>Social Media</h2>
          <a href="https://twitch.tv/noconsolation" target="_blank">Twitch</a>
          <a href="https://www.tiktok.com/@noconsolation?lang=en" target="_blank">TikTok</a>
          <a href="https://www.youtube.com/@thereisnoconsolation" target="_blank">YouTube</a>
          <a href="https://twitter.com/NoConsolation_" target="_blank">Twitter</a>
        </div>
      </div>
    </div>
    <section class="social__media">
      <div class="social__media--wrap">
        <div class="footer__logo">
          <a href="/" id="footer__logo"><i class="fas fa-gem"></i>No Consolation</a>
        </div>
        <p class="website__rights">Â© No Consolation 2023. All rights reserved</p>
        <div class="social__icons">
          <a class="social__icon--link" href="https://twitch.tv/noconsolation" target="_blank"><i class="fab fa-twitch"></i></a>
          <a class="social__icon--link" href="https://discord.gg/dzEZA3Jwm5" target="_blank"><i class="fab fa-discord"></i></a>
          <a class="social__icon--link" href="https://www.youtube.com/@thereisnoconsolation" target="_blank"><i class="fab fa-youtube"></i></a>
          <a class="social__icon--link" href="https://twitter.com/NoConsolation_" target="_blank"><i class="fab fa-twitter"></i></a>
          <a class="social__icon--link" href="https://www.tiktok.com/@noconsolation?lang=en" target="_blank"><i class="fab fa-tiktok"></i></a>
        </div>
      </div>
    </section>
  </div>

  <script src="app.js"></script>

</body>
</html>
