<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>No Consolation</title>
  <link rel="stylesheet" href="stylesspl.css" />
  <link
    rel="stylesheet"
    href="https://use.fontawesome.com/releases/v5.14.0/css/all.css"
    integrity="sha384-HzLeBuhoNPvSl5KYnjx0BT+WB0QEEqLprO+NBkkk5gbc67FTaL7XIGa2w1L0Xbgc"
    crossorigin="anonymous"
  />
  <link
    href="https://fonts.googleapis.com/css2?family=Kumbh+Sans:wght@400;700&display=swap"
    rel="stylesheet"
  />
</head>


  <!-- Navbar Section -->
  <nav class="navbar">
    <div class="navbar__container">
      <a href="/" id="navbar__logo"><i class="fas fa-gem"></i>NC</a>
      <div class="navbar__toggle" id="mobile-menu">
        <span class="bar"></span> <span class="bar"></span> <span class="bar"></span>
      </div>
      <ul class="navbar__menu">
        <li class="navbar__item"><a href="/" class="navbar__links">Home</a></li>
        <li class="navbar__item"><a href="/streaming.html" class="navbar__links">Streaming</a></li>
        <li class="navbar__item"><a href="/podcasts.html" class="navbar__links">Podcasts</a></li>
        <li class="navbar__item"><a href="/roster.html" class="navbar__links">Info</a></li>
        <li class="navbar__item"><a href="/spl.html" class="navbar__links">SPL</a></li>
        <li class="navbar__btn">
          <a href="https://discord.gg/dzEZA3Jwm5" target="_blank" class="button">Get Notified</a>
        </li>
      </ul>
    </div>
  </nav>

  <!-- Secondary Nav Bar -->
  <nav class="sub-navbar">
    <ul class="sub-navbar__menu">
      <li><a href="/spl.html">SPL Home</a></li>
      <li><a href="/spl-stats.html">Stats</a></li>
      <li><a href="/spl-rosters.html">Rosters</a></li>
      <li><a href="/splszn2.html">Season 2</a></li>
    </ul>
  </nav>


<style>
  body {
    font-family: 'Kumbh Sans', sans-serif;
  }

  table {
    border-collapse: collapse;
    margin: 20px auto; /* centers the table */
    text-align: center;
    width: 90%;
    table-layout: fixed; /* equal column width distribution */
    background-color: #666666; /* table background */
    box-shadow: 0 2px 5px rgba(0,0,0,0.1); /* subtle shadow */
  }

  th, td {
    border: 1px solid #000;
    padding: 8px;
    overflow: hidden;
    text-align: center;
  }

  /* Header colors for first 5 tables (SPL) */
  .header-spl th {
    background-color: orangered;
    color: black;
  }

  /* Header colors for last 5 tables (MLS) */
  .header-mls th {
    background-color: teal;
    color: black;
  }

  /* Bold first column */
  td:first-child {
    font-weight: bold;
  }
    select {
    padding: 8px 12px;          /* bigger padding for size */
    font-size: 16px;            /* larger text */
    background-color: #e0e0e0;  /* light grey background */
    border: 1px solid #ccc;     /* subtle border */
    border-radius: 5px;         /* rounded corners */
    min-width: 150px;           /* consistent width */
    cursor: pointer;            /* pointer on hover */
    transition: all 0.2s ease;
    
  }

  select:hover {
    background-color: #d5d5d5;  /* slightly darker on hover */
  }

  select:focus {
    outline: none;
    border-color: #4CAF50;     /* highlight on focus */
    box-shadow: 0 0 5px rgba(0, 128, 0, 0.5);
  }
    option.duplicate {
    color: #999;          /* light grey text */
    font-style: italic;   /* italicized */
  }
  
#submitVote {
  display: block;
  margin: 30px auto 10px auto;
  padding: 16px 0;
  width: 1200px; /* same width as SPL button */
  font-size: 1.2rem;
  font-weight: bold;
  background: linear-gradient(135deg, #8e44ad, #50a5d5);
  color: white;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
  transition: all 0.3s ease;
}

#submitVote:hover {
  background: linear-gradient(135deg, #9b59b6, #8e44ad);
  transform: scale(1.05);
  box-shadow: 0 6px 14px rgba(0, 0, 0, 0.3);
}

#submitVote:disabled {
  background: #666 !important;
  cursor: not-allowed;
  opacity: 0.5;
  transform: none;
  box-shadow: none;
}

  
</style>


<body>
  <div style="text-align: center; margin-top: 40px; margin-bottom: 20px;">
    <h1 style="font-size: 48px; color: #fff; text-decoration: underline;">SPL Season 3 All Star Voting</h1>
    <p style="font-size: 20px; color: #ccc; margin-top: 10px;">
      *Select your top 3, at least 2 series played at that position to qualify, minimum 2 nominees per team, 1 vote per coach*
    </p>
       <p style="font-size: 20px; color: #ccc; margin-top: 10px;">
      *Order in the table was randomized*
    </p>
  </div>
<div style="display: flex; align-items: center; justify-content: center; gap: 12px; margin: 20px 0;">
  <label for="voterSelect" style="color: #ccc; font-size: 1.2rem; display: block; margin-bottom: 8px;">
    Name:
  </label>
  <input
    type="text" 
    id="voterSelect" 
    name="voterSelect" 
    placeholder="Name goes here..." 
    style="padding: 10px 12px; font-size: 1rem; border-radius: 6px; border: 1px solid #aaa; background-color: #222; color: #eee; min-width: 200px; width: 50%;"
  />
</div>



<!-- Example HTML -->
<table id="SPL_ST" border="1"></table>
<table id="SPL_TM" border="1"></table>
<table id="SPL_BM" border="1"></table>
<table id="SPL_DEF" border="1"></table>
<table id="SPL_MGR" border="1"></table>
<table id="MLS_ST" border="1"></table>
<table id="MLS_TM" border="1"></table>
<table id="MLS_BM" border="1"></table>
<table id="MLS_DEF" border="1"></table>
<table id="MLS_MGR" border="1"></table>


<div style="text-align: center; margin: 40px 0;">
  <button id="submitVote" type="button">
    Submit
  </button>
</div>


<script>
const sheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQW0pO7cSa3aO010kP96lDjUyKQKPJldyWkrxUZCsG7kHCrDDzNXFlplYsXQ4VRB4a1_0k9lOApm_1m/pub?gid=1784266098&single=true&output=csv";

// Define your 10 table setups
const tables = [
  { id: "SPL_ST", title:"Striker - SPL", firstCol: ["Petey Piranha1","Bowser1","Peach1","Yoshi1","Luigi2","Mario2"],  range: {rowStart: 4,  rowEnd: 10, colStart: 1, colEnd: 7} }, // B5:H10
  { id: "SPL_TM", title:"Top Mid - SPL",  firstCol: ["Hammer Bro5","The Big Gnosh(MM5)","Tee(MM6)","Mr Monty (MM1)","Saquondo(SG1)","Markley(MM2)"],  range: {rowStart: 12, rowEnd: 18, colStart: 1, colEnd: 7} }, // B15:H20
  { id: "SPL_BM", title:"Bot Mid - SPL", firstCol: ["Hammer Bro7","Dry Bones8","Boo4","Dry Bones5","Terry(TD1)","Dry Bones7"],  range: {rowStart: 20, rowEnd: 26, colStart: 1, colEnd: 7} },
  { id: "SPL_DEF", title:"Defense - SPL", firstCol: ["Toad5","Koopa6","Birdo6","Big Egg(BI7)","Boo2","KOOP(KO2)"],  range: {rowStart: 28, rowEnd: 34, colStart: 1, colEnd: 7} },
  { id: "SPL_MGR", title:"Manager - SPL", firstCol: ["Jaco","Eric","Danny","Austin","Freddy","Adam"],  range: {rowStart: 36, rowEnd: 42, colStart: 1, colEnd: 7} },
  { id: "MLS_ST",  title:"Striker - MLS",firstCol: ["Bowser Jr1","Luigi1","Yoshi2","Donkey Kong2","Wario2","Mario1"],  range: {rowStart: 4, rowEnd: 10, colStart: 10, colEnd: 16} },
  { id: "MLS_TM", title:"Top Mid - MLS", firstCol: ["Monty7","Big Hit Birdo(BI4)","Koopa8","Boo6","Dry Bones1","Kunai(KO3)"],  range: {rowStart: 12, rowEnd: 18, colStart: 10, colEnd: 16} },
  { id: "MLS_BM", title:"Bot Mid - MLs", firstCol: ["Toad8","Kunai(KO3)","Hammer Bro2","Hammer Bro4","Dry Bones2","Jack(DB4)"],  range: {rowStart: 20, rowEnd: 26, colStart: 10, colEnd: 16} },
  { id: "MLS_DEF", title:"Defense - MLS", firstCol: ["Toad8","Dry Bones2","Shy Guy8","Toad7","Shy Guy6","Big Hit Birdo (BI4)"],  range: {rowStart: 28, rowEnd: 34, colStart: 10, colEnd: 16} },
  { id: "MLS_MGR", title:"Manager - MLS", firstCol: ["Colin","Hamilton","Dave","Jake","Reid","Garrett"],  range: {rowStart: 36, rowEnd: 42,colStart: 10, colEnd: 16} }
];

fetch(sheetUrl)
  .then(res => res.text())
  .then(csv => {
    const rows = csv.split("\n").map(r => r.split(","));
    

    tables.forEach(tableDef => {
  const table = document.getElementById(tableDef.id);

        if (!table.dataset.titleAdded) {   // prevent duplicates
            const title = document.createElement("h3");
            title.textContent = tableDef.title;
            title.style.textAlign = "center";
            title.style.marginTop = "75px";
            title.style.marginBottom = "10px";
            title.style.color = "#fff";             // white text
            title.style.fontSize = "24px";          // larger text
            title.style.textDecoration = "underline"; // underline
            table.parentNode.insertBefore(title, table);

        }

  // Assign header color class
  if (["SPL_ST","SPL_TM","SPL_BM","SPL_DEF","SPL_MGR"].includes(tableDef.id)) {
    table.classList.add("header-spl");
  } else {
    table.classList.add("header-mls");
  }

  // Decide which header this table should get
  let headers = null;
  if (["SPL_MGR", "MLS_MGR"].includes(tableDef.id)) {
    headers = ["Coach", "Points", "Win%", "GF/g", "GA/g", "GD", "Snipes"];
  } else {
    headers = ["Player", "Series", "Coach", "Win %", "Goals/g", "Striker Index", "Impact", "+/-"];
  }

  // Insert header row
  const headerRow = document.createElement("tr");
  headers.forEach(h => {
    const th = document.createElement("th");
    th.textContent = h;
    headerRow.appendChild(th);
  });
  table.appendChild(headerRow);

  // adjust for CSV vs sheet: add 4
  const start = tableDef.range.rowStart + 4;
  const end   = tableDef.range.rowEnd + 4;
  const targetRows = rows.slice(start, end);

  const firstColValues = [];

  targetRows.forEach((row, i) => {
    const tr = document.createElement("tr");

    // Hardcoded first column
    const td1 = document.createElement("td");
    td1.textContent = tableDef.firstCol[i] || "";
    tr.appendChild(td1);

    firstColValues.push(tableDef.firstCol[i] || "");

    // Determine number of columns for this row
    const colCount = headers.length - 1;
    for (let j = tableDef.range.colStart; j < tableDef.range.colStart + colCount; j++) {
      const td = document.createElement("td");
      td.textContent = row[j] || "";
      tr.appendChild(td);
    }

    table.appendChild(tr);
  });

  // Create dropdowns
  // Create the form
// Create dropdowns with flexbox
// Create dropdowns with headers
const form = document.createElement("form");
form.style.display = "flex";
form.style.justifyContent = "space-between"; // evenly spaced
form.style.margin = "20px auto";
form.style.width = "90%"; // match table width

const labels = ["First Choice", "Second Choice", "Third Choice"];

for (let i = 0; i < 3; i++) {
    const container = document.createElement("div");
    container.style.display = "flex";
    container.style.flexDirection = "column";
    container.style.alignItems = "center";
    container.style.width = "30%"; // each dropdown takes ~1/3 of table width

    // Header label
    const label = document.createElement("div");
    label.textContent = labels[i];
    label.style.marginBottom = "5px";
    label.style.fontWeight = "bold";
    label.style.color="#ccc";
    container.appendChild(label);

    // Dropdown
    const select = document.createElement("select");
    select.name = tableDef.id + "_select" + (i + 1);
    select.required = true;
    select.style.width = "100%";  // fill the container width
    select.style.fontSize = "16px";  
    select.style.backgroundColor = "#e0e0e0";
    select.style.padding = "8px 12px";
    select.style.borderRadius = "5px";
    select.style.border = "1px solid #ccc";
    select.style.marginBottom = "50px"

    // Add blank default option
    const defaultOption = document.createElement("option");
    defaultOption.value = "";
    defaultOption.textContent = "-- Select --";
    defaultOption.selected = true;
    defaultOption.disabled = true;
    select.appendChild(defaultOption);

    // Add options from first column
    firstColValues.forEach(value => {
        const option = document.createElement("option");
        option.value = value;
        option.textContent = value;
        select.appendChild(option);
    });

    container.appendChild(select);
    form.appendChild(container);
}

// Insert form after the table
table.parentNode.insertBefore(form, table.nextSibling);

        });
  });




document.getElementById("submitVote").addEventListener("click", function () {
  const btn = this;
  btn.disabled = true;
  btn.textContent = "Submitting...";

  const voter = document.getElementById("voterSelect").value || "Missing";

  function getSelectVal(name) {
    const sel = document.querySelector(`select[name='${name}']`);
    return sel ? sel.value || "Missing" : "Missing";
  }

  const categories = [
    "spl_st","spl_tm","spl_bm","spl_df","spl_mgr",
    "mls_st","mls_tm","mls_bm","mls_df","mls_mgr"
  ];

  const data = { voter };

  categories.forEach(cat => {
    for (let i = 1; i <= 3; i++) {
      data[`${cat}_${i}`] = getSelectVal(`${cat}_select${i}`);
    }
  });

  fetch('https://script.google.com/macros/s/AKfycbwkWrb7LxXMV59wPgU2xjRw3VDvCmqP1HWApjhUTHzXev3PEZwJmwm9rtz86BUy4w/exec', {
    method: 'POST',
    body: JSON.stringify(data)
  })
  .then(res => res.text())
  .then(text => {
    if (text === "Success") {
      alert("Vote submitted successfully!");
      document.getElementById("voterSelect").value = "";
      document.querySelectorAll("select").forEach(s => s.selectedIndex = 0);
    } else {
      alert("Error submitting vote: " + text);
    }
  })
  .catch(err => {
    alert("Error submitting vote: " + err.message);
  })
  .finally(() => {
    btn.disabled = false;
    btn.textContent = "Submit";
  });
});


</script>









  <!-- Footer Section -->
  <div class="footer__container">
    <div class="footer__links">
      <div class="footer__link--wrapper">
        <div class="footer__link--items">
          <h2>About Us</h2>
          <a href="/info.html">Mission</a>
          <a href="/info.html">Vision</a>
          <a href="/info.html">Roster</a>
        </div>
        <div class="footer__link--items">
          <h2>Standings</h2>
          <a href="/info.html">Statistics</a>
        </div>
      </div>
      <div class="footer__link--wrapper">
        <div class="footer__link--items">
          <h2>Contact Us</h2>
          <a href="https://discord.gg/dzEZA3Jwm5">Discord</a>
        </div>
        <div class="footer__link--items">
          <h2>Social Media</h2>
          <a href="https://twitch.tv/noconsolation" target="_blank">Twitch</a>
          <a href="https://www.tiktok.com/@noconsolation?lang=en" target="_blank">TikTok</a>
          <a href="https://www.youtube.com/@thereisnoconsolation" target="_blank">YouTube</a>
          <a href="https://twitter.com/NoConsolation_" target="_blank">Twitter</a>
        </div>
      </div>
    </div>
    <section class="social__media">
      <div class="social__media--wrap">
        <div class="footer__logo">
          <a href="/" id="footer__logo"><i class="fas fa-gem"></i>No Consolation</a>
        </div>
        <p class="website__rights">© No Consolation 2023. All rights reserved</p>
        <div class="social__icons">
          <a class="social__icon--link" href="https://twitch.tv/noconsolation" target="_blank"><i class="fab fa-twitch"></i></a>
          <a class="social__icon--link" href="https://discord.gg/dzEZA3Jwm5" target="_blank"><i class="fab fa-discord"></i></a>
          <a class="social__icon--link" href="https://www.youtube.com/@thereisnoconsolation" target="_blank"><i class="fab fa-youtube"></i></a>
          <a class="social__icon--link" href="https://twitter.com/NoConsolation_" target="_blank"><i class="fab fa-twitter"></i></a>
          <a class="social__icon--link" href="https://www.tiktok.com/@noconsolation?lang=en" target="_blank"><i class="fab fa-tiktok"></i></a>
        </div>
      </div>
    </section>
  </div>

  <script src="app.js"></script>

</body>
</html>
